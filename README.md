# FF14 Raid Mechanic Visualizer

FF14（ファイナルファンタジー14）のレイドギミックを視覚的に表現・解説するためのツールです。
[Remotion](https://www.remotion.dev/)を使用して動画を生成し、ブラウザベースのエディタでギミックを編集できます。

## 機能一覧

### フィールド・基本要素
- **フィールドタイプ**: 円形、正方形、長方形に対応
- **背景画像**: フィールドに画像を設定可能（透明度調整可）
- **グリッド表示**: 座標確認用のグリッド表示切り替え
- **フィールドマーカー**: A/B/C/D、1/2/3/4マーカーの配置

### プレイヤー・敵
- **8人パーティ対応**: T1/T2/H1/H2/D1/D2/D3/D4のロール表示
- **敵（ボス）配置**: サイズ・色のカスタマイズ可能
- **移動アニメーション**: プレイヤー・ボスの移動をタイムラインで制御
- **イージング**: linear/easeIn/easeOut/easeInOut対応

### AoE（攻撃範囲）
- **円形AoE**: 半径指定
- **扇形AoE**: 角度・方向・長さ指定
- **直線AoE**: 幅・長さ・方向指定
- **ドーナツAoE**: 内側・外側半径指定
- **十字AoE**: 腕の幅・長さ指定
- **フェードイン/アウト**: 表示・非表示のアニメーション

### デバフシステム
- **デバフ付与**: プレイヤーへのデバフ付与・解除
- **残り時間表示**: カウントダウン表示
- **カスタムアイコン**: 色・名前のカスタマイズ

### テキスト・注釈
- **説明テキスト**: 画面上部/下部/中央に表示
- **ロール別テキスト**: ロールごとに異なるテキスト表示
- **テキスト注釈**: フィールド上の任意位置にテキスト配置
- **詠唱バー**: ボスの詠唱バー表示

### ギミックオブジェクト
- **形状**: 円形、四角形、三角形、ひし形
- **プリセット**: 塔、爆弾、雷、炎、氷などのプリセット
- **絵文字アイコン**: 任意の絵文字を表示可能
- **フェードアニメーション**: 表示・非表示のフェード

### エディタ機能
- **ビジュアルエディタ**: ドラッグ＆ドロップで要素を配置
- **タイムラインエディタ**: フレーム単位でイベントを編集
- **プロパティパネル**: 選択した要素のプロパティを編集
- **オブジェクトリスト**: 全要素の一覧表示
- **Undo/Redo**: 操作の取り消し・やり直し
- **グリッドスナップ**: 0.5単位でのスナップ
- **ズーム**: Ctrl+スクロールでズーム

### インポート・エクスポート
- **JSON出力**: ギミックデータのエクスポート
- **動画出力**: MP4形式での動画生成
- **FFLogsインポート**: FFLogsからのデータ取り込み（実験的）

## セットアップ

### 必要環境
- Node.js 18以上
- npm または yarn

### インストール

```bash
git clone <repository-url>
cd ff14-raid-visualizer
npm install
```

## ローカル実行

### エディタの起動

```bash
npm run dev:editor
```

ブラウザで `http://localhost:3000` を開きます。

### Remotion Studioの起動

```bash
npm start
```

Remotion Studioが起動し、プレビューと動画出力ができます。

### 開発サーバー（エディタ + レンダーサーバー）

```bash
npm run dev:all
```

エディタとレンダーサーバーを同時に起動します。

## 動画出力

### Remotion Studio経由

1. `npm start` でRemotionスタジオを起動
2. 右上の「Render」ボタンをクリック
3. 出力設定を選択してレンダリング

### コマンドライン

```bash
# デフォルト出力
npm run build

# 出力先: out/video.mp4
```

### エディタから出力

1. エディタ右上の「動画出力」ボタンをクリック
2. 設定を確認して「レンダリング開始」

## プロジェクト構成

```
src/
├── components/          # 描画コンポーネント
│   ├── aoe/            # AoE描画
│   ├── debuff/         # デバフアイコン
│   ├── enemy/          # 敵描画
│   ├── field/          # フィールド描画
│   ├── marker/         # マーカー描画
│   ├── player/         # プレイヤー描画
│   └── ui/             # UI要素（テキスト、詠唱バー等）
├── compositions/        # Remotion用コンポジション
├── data/               # 型定義・サンプルデータ
│   ├── types.ts        # TypeScript型定義
│   ├── constants.ts    # 定数
│   └── sampleMechanic.ts
├── editor/             # エディタ関連
│   ├── components/     # エディタUIコンポーネント
│   │   ├── properties/ # プロパティパネル
│   │   └── timeline/   # タイムラインエディタ
│   ├── context/        # React Context（状態管理）
│   ├── hooks/          # カスタムフック
│   └── utils/          # ユーティリティ関数
├── hooks/              # 共通フック
├── parser/             # FFLogsパーサー
├── server/             # レンダーサーバー
├── utils/              # 共通ユーティリティ
├── RaidMechanicVideo.tsx  # メイン動画コンポーネント
├── Root.tsx            # Remotionルート
└── index.ts            # エントリーポイント
```

## 技術スタック

- **React** - UIフレームワーク
- **TypeScript** - 型安全な開発
- **Remotion** - React動画生成
- **Vite** - 開発サーバー・ビルド
- **Tailwind CSS** - スタイリング

## スクリプト一覧

| コマンド | 説明 |
|---------|------|
| `npm start` | Remotion Studioを起動 |
| `npm run dev:editor` | エディタを起動 |
| `npm run dev:server` | レンダーサーバーを起動 |
| `npm run dev:all` | エディタ+サーバーを同時起動 |
| `npm run build` | 動画をレンダリング |
| `npm run build:editor` | エディタをビルド |
| `npm run upgrade` | Remotionをアップグレード |

## ライセンス

ISC
