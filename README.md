# FF14 Raid Mechanic Visualizer

FF14（ファイナルファンタジー14）のレイドギミックをブラウザ上で視覚化・編集できるエディタです。
プレイヤーの配置・移動、AoE、デバフ、テキストなどをタイムライン上で管理し、ギミック攻略の解説動画を作成できます。

## 主な機能

### フィールド
- 円形・正方形・長方形フィールドに対応
- 背景画像の設定（透明度調整可）
- グリッド表示（座標確認用）
- フィールドマーカー（A/B/C/D、1/2/3/4）

### プレイヤー・敵
- 8人パーティ（T1/T2/H1/H2/D1/D2/D3/D4）
- 敵（ボス）の配置・サイズ・色カスタマイズ
- 移動アニメーション（linear/easeIn/easeOut/easeInOut）

### AoE（攻撃範囲）
- 円形・扇形・直線・ドーナツ・十字
- フェードイン/アウトアニメーション
- 起点設定（固定/ボス/プレイヤー/オブジェクト）
- 追従モード（設置型/ソース追従/ターゲット追従）

### デバフ
- プレイヤーへのデバフ付与・解除
- カウントダウン表示
- カスタムアイコン（色・名前）

### テキスト・注釈
- 説明テキスト（上部/下部/中央）
- ロール別テキスト
- フィールド上のテキスト注釈
- 詠唱バー表示

### ギミックオブジェクト
- 形状（円形・四角形・三角形・ひし形）
- プリセット（塔・爆弾・雷・炎・氷など）
- 絵文字アイコン
- フェードアニメーション

## エディタの使い方

### 基本操作
- **ドラッグ＆ドロップ**: プレイヤーやオブジェクトを直接移動
- **タイムライン**: 画面下部のタイムラインでフレーム単位のイベント管理
- **プロパティパネル**: 右側のパネルで選択要素のプロパティを編集
- **ズーム**: Ctrl+スクロールでフィールドのズーム

### サンプルギミック
初めての方は、サンプルギミックを読み込んで操作を試せます。
- **WelcomeDialog**: 初回起動時のガイド最終ページ「サンプルギミックを試す」ボタン
- **EditorHeader**: 上部メニューの「Sample」ボタン

### 保存・読み込み
- **自動保存**: 編集内容はブラウザに自動保存されます（閉じても復元）
- **保存スロット**: 「保存・読込」ボタンから複数のスロットに保存可能
- **JSON入出力**: 「Export JSON」でファイル保存、「Import JSON」で読み込み

### URL共有
「Share URL」ボタンでギミックデータをURLに埋め込み、他の人と共有できます。

### タイムラインインポート
タイムラインデータのJSONインポートに対応しています。フォーマットの詳細は [docs/timeline-import-spec.md](docs/timeline-import-spec.md) を参照してください。

### 動画出力
「ブラウザ出力」ボタンからMP4/WebM形式で動画を出力できます。ブラウザ内で完結するため、サーバー不要です。

## キーボードショートカット

### 再生・タイムライン操作
| キー | 説明 |
|------|------|
| `Space` | 再生/一時停止 |
| `←` / `→` | 1フレーム戻る/進む |
| `Shift+←` / `Shift+→` | 10フレーム戻る/進む |
| `Home` / `End` | 最初/最後のフレームへ |

### 要素操作
| キー | 説明 |
|------|------|
| `Alt+矢印` | プレイヤーを移動（0.5単位） |
| `Alt+Shift+矢印` | プレイヤーを移動（1単位） |
| `Delete` | 選択中のオブジェクトを削除 |
| `Escape` | 選択解除 & ツールリセット |
| `Ctrl+A` | 全プレイヤーを選択 |
| `Ctrl+D` | 選択オブジェクトをコピー |

### 編集
| キー | 説明 |
|------|------|
| `Ctrl+Z` | 元に戻す |
| `Ctrl+Shift+Z` | やり直し |
| `Ctrl+S` | JSONを保存 |

### ツール切替
| キー | 説明 |
|------|------|
| `1` | 選択ツール |
| `2` | 移動ツール |
| `3` | 移動イベント追加 |
| `4` | AoE追加 |
| `5` | デバフ追加 |
| `6` | テキスト追加 |
| `7` | オブジェクト追加 |
| `?` | ショートカットヘルプ |

## 開発者向け

### 必要環境
- Node.js 18以上
- npm

### ローカル開発

```bash
npm install
npm run dev:editor
```

ブラウザで `http://localhost:3000` を開きます。

### スクリプト一覧

| コマンド | 説明 |
|---------|------|
| `npm run dev:editor` | エディタを開発モードで起動 |
| `npm run build:editor` | エディタをビルド |

### プロジェクト構成

```
src/
├── components/          # 描画コンポーネント
│   ├── aoe/            # AoE描画
│   ├── debuff/         # デバフアイコン
│   ├── enemy/          # 敵描画
│   ├── field/          # フィールド描画
│   ├── marker/         # マーカー描画
│   ├── player/         # プレイヤー描画
│   └── ui/             # UI要素（テキスト、詠唱バー等）
├── data/               # 型定義・サンプルデータ
│   ├── types.ts        # TypeScript型定義
│   ├── constants.ts    # 定数
│   ├── sampleMechanic.ts
│   └── sampleLethalScourge.ts
├── editor/             # エディタ関連
│   ├── components/     # エディタUIコンポーネント
│   │   ├── properties/ # プロパティパネル
│   │   └── timeline/   # タイムラインエディタ
│   ├── context/        # React Context（状態管理）
│   ├── hooks/          # カスタムフック
│   └── utils/          # ユーティリティ関数
├── hooks/              # 共通フック
├── utils/              # 共通ユーティリティ
├── RaidMechanicVideo.tsx  # メイン動画コンポーネント
└── Root.tsx            # Remotionルート
docs/
└── timeline-import-spec.md  # タイムラインインポート仕様
```

### 技術スタック
- **React** - UIフレームワーク
- **TypeScript** - 型安全な開発
- **Remotion** - React動画生成
- **Vite** - 開発サーバー・ビルド

## ライセンス

ISC
